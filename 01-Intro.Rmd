---
output:
  pdf_document: default
  html_document: default
---

\mainmatter

# Introduction {#intro}
## The central role of vegetation in the Earth system

Plants and vegetation play an essential role in the earth system. In Figure \@ref(fig:f1), we have represented the planetary boundaries and the significant environmental challenges we are facing. For some of them, we are reaching the system's boundary, such as genetic diversity, biogeochemical cycling, and climate change. Plants and forests ecosystems are critical in some of these planetary problems. Therefore, it is crucial to understand how vegetation reacts to environmental problems (positive or negative feedback).

```{r f1, fig.cap='The planetary boundaries (www.stockholmresilience.org)', out.width='60%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/planetary_boundaries.png')
```

A more specific example is the global carbon budget. We are currently facing this significant change in biogeochemical cycling due to the rising fossil fuel emission over the last 150 years. Figure \@ref(fig:f2) represents the balance between carbon sources (fossil carbon and land-use changes) and sinks (oceans, land, and atmosphere). The more we emit, the more the Earth system is capturing, as shown in Fig.2. These take us to a question, taken frequently by the models, about how long these sinks will continue or not capture our increasing carbon emissions. It is also important to highlight the high annual variability of the land component being the most challenging component to predict. 

```{r f2, fig.cap='The global carbon budget (www.globalcarbonproject.org)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/carbon_budget.png')
```

**Climate Models** predicts the long-term weather variation and average weather, how they will evolve. These models include the atmosphere, land and ocean component (Fig.3, top). The original climate models focus on biophysics: energy and water balances, predicting precipitation, radiation and fluxes between the three components.
More recently, climate models have evolved into **Earth System Models** (ESM). ESM have a more complex concept because it represents more processes (Fig.3, bottom). Why? If you want to predict the end of the century climate, we need to consider greenhouse gases. EMS are more complex but also more realistic. Vegetation models are usually the land component of ESM.

```{r f3, fig.cap='Scientific scope of (a) climate models and (b) earth system models. (Bonan 2019)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/GCM_ESM.jpg')
```

Vegetation models are often the land component of an earth system model.

- simulates **energy fluxes**: radiation, evapotranspiration and sensible heat fluxes between land and the atmosphere. Depending on the vegetation type, the impacts are different.
- simulates the **hydrology** and the **carbon cycle**.
- slower processes like **vegetation dynamics**: the succession of forest or **land use** and **urbanization**.

```{r f4, fig.cap='Scientific scope of terrestrial biosphere model. (Bonan 2019)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/cycles_bonan.jpg')
```

The biosphere acts as a coupler in models. The coupler is a system that links different models. The vegetation provides the link between land and atmosphere component.


## Why do we need modelling?

Modelling has proven to be a handy tool for:

- For **understanding**: we need good theoretical foundations (understand processes) to generalize in space and time.
- For **prediction**, how vegetation responds to expected changes (temperature or CO2) to implant management strategies and policies.
- For **data integration**: a framework to bring together multiple data sources.

\pagebreak

## Model types

\begin{center}
\captionof{table}{Continuum of terrestrial biosphere/ecosystem models. (Bonan 2019)}
\label{table:example}
```{r Gases, out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/table_model_types.png')
```
\end{center}

How can we look at these models' types? We can divide these model types into empirical models or process-based models. **Empirical models** are based on data and correlations, not describing precisely describing the biophysical processes — **process-based models** describing the biophysical processes and causal relations between the variables (Table \@ref(table:example)). Most models are hybrid.


\begin{center}
\captionof{table}{Continuum of process-based versus empirical models. (Adams et al. 2013)}
\label{table:empricial}
```{r f6, out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/tables_PB_empirical.png')
```
\end{center}


The model type depends on:
- Purpose: will it be used for management support, policy support, research.
- Question: different people will be interested in different questions (forester, ecologist,…)
- Scale: models that are to be applied for local use can be much more detailed than worldwide models because data gathering is much more straightforward on a small scale. 


## The history of vegetation models

The first vegetation models have emerged in 1960 and 1970. There are some parallel evolutions during that time because of computers emerging, making it possible to study more complex systems. 

One of the first models was the **box models** (1960); these models describe the flow of mass and energy thought boxes. These models still exist in currently biogeochemical models, where arrows represent the fluxes between the pools. In parallel, the **gap models** had emerged. They were developed by forestry scientists using forest inventories derived from growth, regeneration, and mortality in response to environmental variables. In 1973, the first model was developed to derived global net primary productivity, relating in an empirical way to climate variables (temperature) with vegetation productivity—the first attempt to make a global upscaling of a process. In the 1980s surged the first **land surface models**. Land surface models start the models where the other models start to integrate – **Terrestrial biosphere models** (see Figure \@ref(fig:f7)), which are now the state-of-the-art land components ESMs.
Vegetation modelling is a very interdisciplinary field because it involves knowledge of different scientific fields, making it difficult to find a common terminology. EMS are still not good to simulate vegetation dynamics. 

```{r f7, fig.cap='Timeline showing the parallel development of model types and the integration of model types into land surface models towards terrestrial biosphere models. (Bonan 2019)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/timeline.jpg')
```


## Components of a model

What is a vegetation model?

- **Dynamic global vegetation models** (DGVMs) are powerful tools to project past, current and future vegetation patterns and associated biogeochemical cycles (Scheiter et al., 2013).
- A **Dynamic Global Vegetation Model** (DGVM) is a computer program that simulates shifts in potential vegetation and its associated biogeochemical and hydrological cycles as a response to shifts in climate. DGVMs use time series of climate data and, given constraints of latitude, topography, and soil characteristics, simulate monthly or daily dynamics of ecosystem processes. DGVMs are used most often to simulate the effects of future climate change on natural vegetation and its carbon and water cycles (Wikipedia 2021).

\begin{center}
\captionof{table}{Definition of key model components and examples for a typical TBM}
\label{table:components}
```{r f8, out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/table_components.png')
```
\end{center}



### Processes

Key component because we are focusing on process-based models. There is an all list of processes (energy, water, turbulent transport, canopy scaling, carbon, nitrogen, trace gasses, demography,…) that integrates the models, especially the more complex ones. These processes will be discussed in detail in the following theory lectures and how to translate them into equations.

### Equations

Representations of the processes. However, it is impossible to insert any equation into the model because there are important constraints, such as the specific time. For example, it makes little sense to resolve the equation for forest composition (succession) every day. This is a prolonged process with an extremely low variance between consecutive days. The solution for the equation for photosynthesis, on the other hand, varies significantly throughout the day and between consecutive days (cloudy day vs sunny day).
There are three types of equations within the model: 
- **prognostic equations**: time derivatives of differential equations – calculate the state's change over time
- **conservation equations**: conservation of mass and energy
- **diagnostic equations**: linking multiple variables independent from the time. Often there is no analytical solution in biological systems; therefore, we must use numerical methods to solve the equations.


### Parameters

Constants in the model. Some parameters are quite uncertain because we can not measure very well or on the scale, we want to use. For example, we can be confident of the photosynthetic capacity of a leaf. Upscaling this result so that it is applicable for a forest or multiple PTF (plant functional types) induces uncertainty. The more parameters a model uses, the more uncertainties that are to be taken into account!

### Time Steps

Vegetation models run at multiple timescales (combining processes that are resolved at multiple timescales). Models present fast processes, which are calculated every hour (photosynthesis and energy balance), intermediate processes calculated daily (carbon allocation and growth) and slow processes in order of years (mortality) (Fig.6).  

```{r f9, fig.cap='Structure of a vegatation model indicating the different time steps at which each process is simulated (Williams et al. 2009)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/time_steps.png')
```

### Spatial structure

Division of space or how many times we repeat our calculations in space. The global models have a spatial grid of 100km or even more and divide the landscape into patches. In each patch, they simulate the forest (or savannas, grassland…). Models also have a horizontal grid or horizontal layering: some models consider multiple soil layers. The same is true for above ground layers, where some models divide the canopy into multiple layers (Figure \@ref(fig:f10)). 
For example, the Ecosystem Demography Model (ED2.2) divides the forest into multiple grid cells where the same meteorological conditions apply within each grid cell. Then within each cell, he has different sites with different soils. Each site is divided into multiple patches (forests with a similar disturbance history). Into each patch, we simulate different cohorts of trees (Figure \@ref(fig:f11)).

```{r f10, fig.cap='Three dimensional grid of a TBM structured in terms of longitude x latitude x level. The number of soil and canopy layers and the geographical resolution is model dependent, (Bonan 2019)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/grid_vert_hor.jpg')
```

```{r f11, fig.cap='Example: the spatial multi-level grid structure of of the ED2 vegetation model (Longo et al. 2019)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/grid_ED2.png')
```

### Model code, complexity and uncertainty

There is a gap between equations and model code. Also, it is a variety of how a specific process is implemented in an equation. Usually, large models also contained a "technical debt", which means over the years, multiple modellers have continued working on models and add code lines, but at some point, the code is so large that anyone knows all code. 

Models are always a simplification of the real world, but they tend to become overly complex

More complex models (adding more processes) become more realistic, but we also add more uncertainty sources. Therefore, we should choose our model carefully based on a research question.

### Data

Not possible to develop models without data. In general, the more data (multiple data sources), the better.

## Modelling workflow and structure of the course

Vegetation modelling is a multidisciplinary field. This course will mainly focus on the mathematical formulation of processes and translating these equations into a working model. 

```{r f12, fig.cap='Progression through spatial and temporal scales throughout this course', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/course_overview.png')
```

The construction of a model is a continuous process – a model is never finished. As Figure 10 shows us, we start by describing our system in the form of equations, then running the computer program to characterize the model, perform parameter estimation and interpretation, and then apply it to other locations and validate against independent data.

```{r f13, fig.cap='Model data fusion in every step of the model development cycle (Williams et al. 2009)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/williams_fusion.png')
```

```{r f14, fig.cap='Methodological workflow of model data fusion (Dietze: Ecological Forecasting)', out.width='80%', fig.asp=.75, fig.align='center',echo=FALSE}
knitr::include_graphics('figures/chap1/dietze_workflow.png')
```

